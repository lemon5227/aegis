# Aegis 成熟版瀑布计划（用户高频优先）

## 1. 目标

在不引入广告系统的前提下，将 Aegis 从“可用原型”推进到“成熟论坛产品”。

执行原则：

- 严格瀑布顺序，不跳阶段。
- 每次只做一个阶段内的功能。
- 每完成一个阶段，必须：更新文档 -> 完整测试 -> 推送。

---

## 2. 阶段顺序（冻结）

### Phase 1 - 核心体验打磨（P0）

目标：优先优化用户最高频链路（发帖、看帖、评论、切换）。

范围：

1. 发帖/评论交互反馈统一（加载态、错误态、成功态）。
2. 详情与列表状态一致性（删除/编辑/投票后刷新一致）。
3. 首屏与常用视图切换体验优化（Feed/Discover/PostDetail）。

DoD：

- 新用户 5 分钟内可完成“发帖 + 评论 + 收藏 + 返回列表”闭环。
- 不出现明显状态错乱（列表有、详情无，或反之）。

### Phase 2 - 通知中心（P0）

目标：上线高频留存能力（回复、@、系统通知）。

范围：

1. 通知模型与存储。
2. 未读/已读、批量已读。
3. 通知点击跳转定位（帖子/评论）。

DoD：

- 关键互动事件可稳定到达通知中心。
- 点击通知可定位到正确内容。

### Phase 3 - 搜索与发现增强（P1）

目标：提升“找内容”效率。

范围：

1. 搜索结果筛选（Sub/作者/时间）。
2. 排序增强（New/Hot/Top: day/week/month/all）。
3. 结果分页与空态优化。

DoD：

- 常见检索路径 3 次内可命中目标内容。

### Phase 4 - 社区运营工具（P1）

目标：让社区管理员可日常运营。

范围：

1. 置顶、加精、锁帖。
2. 社区规则页与公告区。
3. 管理动作日志可追踪。

DoD：

- 管理员可独立完成一次“公告 + 置顶 + 锁帖”操作闭环。

### Phase 5 - 举报审核闭环（P1）

目标：建立完整内容治理流程。

范围：

1. 举报入口（帖子/评论/用户）。
2. 审核队列与处理动作。
3. 举报状态回执。

DoD：

- 举报 -> 受理 -> 处理 -> 回执全链路可追踪。

### Phase 6 - 可靠性与可观测性强化（P0）

目标：把异常从“偶发现象”变成“可检测、可恢复、可回归”。

范围：

1. 关键链路重试与错误分级。
2. 双节点/三节点自动回归门禁。
3. 关键同步与发布指标埋点。

DoD：

- 发布/同步异常可定位、可复现、可回归。

### Phase 7 - 反垃圾与风控（P1）

目标：降低灌水和恶意内容干扰。

范围：

1. 发帖/评论频率限制。
2. 短时重复内容拦截。
3. 新号冷启动限制策略。

DoD：

- 常见刷屏路径被稳定限制，误伤可控。

### Phase 8 - 发布与运维标准化（P0）

目标：形成稳定发布节奏与回滚能力。

范围：

1. 发布检查清单（功能、数据、回滚）。
2. 故障分级与处理预案。
3. 版本记录与变更审计。

DoD：

- 每次发布具备可回滚与可追踪记录。

---

## 3. 阶段执行模板（每阶段固定）

1. 设计冻结
- 确认数据模型、API、UI、验收用例。

2. 实现
- 严禁混入后续阶段需求。

3. 文档更新
- 将当前阶段从 `In Progress` 更新为 `Done`。
- 记录变更摘要与关键决策。

4. 完整测试

```bash
cd aegis-app && go test ./...
cd aegis-app/frontend && npm run build
cd aegis-app && ./scripts/run_g6_gate_checks.sh
```

并执行手工联调清单（至少双节点）：

- 发帖、评论、删除、收藏、同步一致性。
- 当前阶段新增能力的主流程/异常流程。

5. 推送

```bash
git add -A
git commit -m "phase-x: <功能名> complete with full validation"
git push origin master
```

---

## 4. 当前状态

- Phase 1: In Progress
- Phase 2: Pending
- Phase 3: Pending
- Phase 4: Pending
- Phase 5: Pending
- Phase 6: Pending
- Phase 7: Pending
- Phase 8: Pending
